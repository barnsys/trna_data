library("phangorn")

pas<-read.dna("V2_analyse.fas", format="fasta")

dat<-as.phyDat(pas)

tre_1<-read.tree("trees-1.txt")
tre_2<-read.tree("trees-2.txt")

nrow(tre_1$edge)
nrow(tre_2$edge)


tre_1$edge.length<-rep(0.01, 36)
tre_2$edge.length<-rep(0.01, 36)


fit1<-pml(tree=tre_1, data=dat)
fit1.opt<-optim.pml(fit1, optQ=TRUE, optBf=TRUE, optInv=TRUE, optGamma=TRUE, optEdge=TRUE)

fit2<-pml(tree=tre_2, data=dat)
fit2.opt<-optim.pml(fit2, optQ=TRUE, optBf=TRUE, optInv=TRUE, optGamma=TRUE, optEdge=TRUE)

fit1.opt$logLik
fit2.opt$logLik
1-pchisq(2*sqrt((fit1.opt$logLik-fit2.opt$logLik)^2), 1)


AIC(fit1.opt)
AIC(fit2.opt)
sqrt((AIC(fit1.opt)-AIC(fit2.opt))^2)

BIC(fit1.opt)
BIC(fit2.opt)
sqrt((BIC(fit1.opt)-BIC(fit2.opt))^2)